clc; clear all; close all;

radius=6371220;
N=[16 32 64 128 256 512];
dx=2*pi*radius./(4*N);
% e1=[3.3707*10^-4 2.0751*10^-5 1.2964*10^-6 8.1231*10^-8 5.0903*10^-9 3.1888*10^-10];
% e2=[3.1674*10^-4 1.9593*10^-5 1.2274*10^-6 7.6985*10^-8 4.8271*10^-9 3.0280*10^-10];
% e3=[3.7839*10^-4 2.5503*10^-5 1.8238*10^-6 1.2133*10^-7 7.8110*10^-9 4.9564*10^-10];

% e1=[4.4656*10^-5 2.9404*10^-6 1.8859*10^-7 1.1972*10^-8 7.5548*10^-10 4.7499*10^-11];
% e2=[5.2622*10^-5 3.4964*10^-6 2.2566*10^-7 1.4352*10^-8 9.0630*10^-10 5.7106*10^-11];
% e3=[1.1018*10^-4 8.9432*10^-6 6.3993*10^-7 4.2842*10^-8 2.7721*10^-9 1.7640*10^-10];

e1=[4.4464*10^-4 2.7567*10^-5 1.7319*10^-6 1.0886*10^-7 6.8327*10^-9 4.2837*10^-10];
e2=[4.2619*10^-4 2.6414*10^-5 1.6606*10^-6 1.0438*10^-7 6.5488*10^-9 4.1045*10^-10];
e3=[5.7206*10^-4 4.3945*10^-5 3.0870*10^-6 2.0521*10^-7 1.3242*10^-8 8.4121*10^-10];

% e1=[9.5570*10^-5 6.2727*10^-6 4.0293*10^-7 2.5561*10^-8 1.6119*10^-9 1.0140*10^-10];
% e2=[1.1354*10^-4 7.4509*10^-6 4.7991*10^-7 3.0505*10^-8 1.9247*10^-9 1.2102*10^-10];
% e3=[2.5127*10^-4 1.9429*10^-5 1.3703*10^-6 9.1295*10^-8 5.8964*10^-9 3.7487*10^-10];

% e1=[2.4373*10^-3 1.6193*10^-4 1.0351*10^-5 6.5310*10^-7 4.0991*10^-8 2.5671*10^-9];
% e2=[2.3263*10^-3 1.5486*10^-4 9.9131*10^-6 6.2580*10^-7 3.9290*10^-8 2.4608*10^-9];
% e3=[3.1250*10^-3 2.5748*10^-4 1.8414*10^-5 1.2296*10^-6 7.8432*10^-8 5.0468*10^-9];

% e1=[1.1430*10^-5 4.0438*10^-7 2.0910*10^-8 1.2176*10^-9 7.3855*10^-11 4.5993*10^-12];
% e2=[1.4758*10^-5 8.1813*10^-7 6.4914*10^-8 5.4953*10^-9 4.7583*10^-10 4.1633*10^-11];
% e3=[2.8075*10^-5 3.0386*10^-6 3.7356*10^-7 4.3567*10^-8 5.2230*10^-9 6.3823*10^-10];

% e1=[1.3883*10^-5 5.2773*10^-7 2.7072*10^-8 1.5547*10^-9 9.3430*10^-11 5.7731*10^-12];
% e2=[1.8078*10^-5 1.1000*10^-6 8.4090*10^-8 6.9357*10^-9 5.9230*10^-10 5.1460*10^-11];
% e3=[3.9774*10^-5 4.5644*10^-6 4.9238*10^-7 5.6815*10^-8 6.8074*10^-9 8.2825*10^-10];

ldx=log10(dx);
le1=log10(e1);
le2=log10(e2);
le3=log10(e3);

%% plot 1
figure(11); 
%% curve 1
hl1=plot(ldx,le1,'ok');
set(hl1,'LineWidth',2.0);
set(hl1,'MarkerSize',10);
set(hl1,'MarkerEdgeColor','k');

hold on;
[a1,b1]=polyfit(ldx,le1,1);
tt=linspace(min(ldx),max(ldx),10);
lsq1=a1(2)+a1(1)*tt;
% %% courbes...
hlf1=plot(tt,lsq1,'-b');
set(hlf1,'LineWidth',2.0);


%% curve 2
hl1=plot(ldx,le2,'ok');
set(hl1,'LineWidth',2.0);
set(hl1,'MarkerSize',10);
set(hl1,'MarkerEdgeColor','k');

hold on;
[a2,b1]=polyfit(ldx,le2,1);
tt=linspace(min(ldx),max(ldx),10);
lsq1=a2(2)+a2(1)*tt;
% %% courbes...
hlf2=plot(tt,lsq1,'-g');
set(hlf2,'LineWidth',2.0);

%% curve 3
hl1=plot(ldx,le3,'ok');
set(hl1,'LineWidth',2.0);
set(hl1,'MarkerSize',10);
set(hl1,'MarkerEdgeColor','k');

hold on;
[a3,b1]=polyfit(ldx,le3,1);
tt=linspace(min(ldx),max(ldx),10);
lsq1=a3(2)+a3(1)*tt;
% %% courbes...
hlf3=plot(tt,lsq1,'-r');
set(hlf3,'LineWidth',2.0);

ha=gca;
xa=get(gca,'Xlabel');
set(ha,'Xgrid','on');
set(xa,'String','Log_{10}(dx)');
set (xa,'FontName','Calibri');
set(xa,'FontSize',12);

% ylabel
ha=gca;
ya=get(gca,'Ylabel');
set(ha,'Ygrid','on');
set(ya,'String','Log_{10}(error)');
set (ya,'FontName','Calibri');
set(ya,'FontSize',12);

%% legend
legend([hlf1,hlf2,hlf3],{['norm 1 - slope = ' num2str(a1(1))],['norm 2 - slope = ' num2str(a2(1))],['norm \infty - slope = ' num2str(a3(1))]},'Location','SouthEast')
