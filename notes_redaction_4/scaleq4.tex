% equation scalaire

\chapter{Equations scalaires}

\section{Equations d'advection sur la sphère}

Dans cette partie, on s'intéresse à l'équation d'advection \eqref{eq:advection_sphere} :
\begin{equation}
\left\lbrace
\begin{array}{rcl}
\dfrac{\partial h}{\partial t} + \mathbf{c}(t,\mathbf{x}) \cdot \nabla_T h & = & 0 \\
h(\mathbf{x},0) & = & h_0(\mathbf{x})
\end{array}
\right. \text{ pour tout } \mathbf{x} \in \mathbb{S}_a^2 \text{ et } t \geq 0,
\label{eq:advection_sphere}
\end{equation}
sur la sphère de rayon $a$, $\mathbb{S}_a^2$, avec $a$ le rayon terrestre est $a = 6 371 220 \si{m}$.
La fonction $\mathbf{c} : (t,\mathbf{x}) \in \mathbb{R}^+ \times \mathbb{S}_a^2 \mapsto \mathbf{c}(t,\mathbf{x}) \in \mathbb{T}_{\mathbf{x}} \mathbb{S}_a^2$ désigne un champ de vecteurs tangents à la sphère $\mathbb{S}_a^2$.

\subsection{Résolution numérique}

L'équation \eqref{eq:advection_sphere} est résolue par la méthode des lignes en utilisant l'opérateur gradient discret $\nabla_{T,\Delta}$. On pose $J_{\Delta}$ l'application agissant sur une fonction de grille donnée par
\begin{equation}
J_{\Delta}(t, h) = - \mathbf{c}(t,\cdot) \nabla_{T,\Delta} h.
\end{equation}
La résolution en temps se fait par un algorithme de type $RK4$ couplé à un opérateur de filtrage $\mathcal{F}$. L'algorithme obtenu est le suivant :

\begin{center}
\begin{minipage}[H]{12cm}
  \begin{algorithm}[H]
    \caption{: Equation d'advection sphérique \eqref{eq:advection_sphere} }\label{alg:RK4_transportSa}
    \begin{algorithmic}[1]
    \State $h^0 = h_0^*$ connu,
    \For{$n=0,1, \ldots$}
             \State  $K^{(1)} = J_{\Delta}(t^n, h^n)$,
             \State  $K^{(2)} = J_{\Delta}\left(t^n + \frac{\Delta t}{2}, h^n + \frac{\Delta t}{2} K^{(1)} \right)$,
             \State  $K^{(3)} = J_{\Delta}\left(t^n + \frac{\Delta t}{2}, h^n + \frac{\Delta t}{2} K^{(2)} \right)$,
             \State  $K^{(4)} = J_{\Delta}\left(t^n + \Delta t h^n + \Delta t K^{(3)} \right)$,  
             \State  $h^{n+1} = \mathcal{F}\left( h^n  + \dfrac{\Delta t}{6} \left( K^{(1)} + 2 K^{(2)} + 2 K^{(3)} + K^{(4)} \right) \right)$.
            \EndFor
    \end{algorithmic}
    \end{algorithm}
\end{minipage}
\end{center}

$h^n$ désigne une approximation de $h^*(t^n)$ solution au temps $t^n = n \Delta t$ de \eqref{eq:advection_sphere}.
Lorsqu'une solution exacte de l'équation \eqref{eq:advection_sphere} est disponible, nous mesurons l'erreur relative au temps $t^n$
\begin{equation}
e_s^n = \dfrac{\| h^n - h_*(t^n) \|_s}{\| h_*(t^n) \|_s}
\end{equation}
où $s \in \left\lbrace 1, 2, \infty \right\rbrace$ et $\| \cdot \|_s$ désigne la norme $1$, $2$ ou $\infty$ calculée par
\begin{equation}
\| q^* \|_s = \left( Q(|q^*|^s ) \right)^{1/s} \text{ avec } s=1,2
\end{equation}
et $Q$ est un opérateur de quadrature numérique étudié dans \cite{Portelenelle2018}. Pour la norme infinie, on note
\begin{equation}
\| q^* \|_{\infty} = \max_{-N/2 \leq i,j \leq N/2} \max_{(k) = (I) ... (VI)} |q(\mathbf{x}_{i,j}^{(k)})|.
\end{equation}
















\subsection{Test de rotation solide}

Le premier test que nous considérons est le premier test de \cite{Williamson1992}. Il s'agit d'une rotation sans déformation de la condition initiale au cours du temps autour d'un axe incliné.

On considère $(\lambda, \theta)$ les coordonnées longitude-latitudes associées à un pôle Nord donné par $\mathbf{N}$ et $(\lambda', \theta')$ les coordonnées longitude-latitudes associées à un pôle Nord déplacé en $\mathbf{P}$ de coordonnées $(\lambda_P, \theta_P)$. La proposition suivante énonce le lien entre $(\lambda, \theta)$ et $(\lambda', \theta')$ :

\begin{proposition}
Les formules suivantes permettent de passer de $(\lambda, \theta)$ à $(\lambda', \theta')$ :
\begin{equation}
\label{from classic to prime}
\left\lbrace 
\begin{array}{rcl}
\theta' & = & \arcsin \left[ \sin( \theta) \sin(\theta_P) + \cos( \theta ) \cos( \theta_P) \cos( \lambda - \lambda_P ) \right] \\
\lambda' & = & \arctan \left[ \dfrac{\cos ( \theta) \sin( \lambda - \lambda_P)}{\cos( \theta) \cos( \lambda - \lambda_P) \sin( \theta_P) - \sin( \theta) \cos( \theta_P)} \right]
\end{array}
\right.
\end{equation}
inversement formules suivantes permettent de passer de $(\lambda', \theta')$ à $(\lambda, \theta)$ :
\begin{equation}
\label{from prime to classic}
\left\lbrace 
\begin{array}{rcl}
\theta & = & \arcsin \left[ \sin( \theta') \sin(\theta_P) - \cos( \theta' ) \cos( \theta_P) \cos( \lambda' ) \right] \\
\lambda & = & \lambda_P + \arctan \left[ \dfrac{\cos ( \theta') \sin( \lambda ')}{\sin( \theta') \cos( \theta_P) + \cos ( \theta') \cos( \lambda') \sin ( \theta_P)} \right]
\end{array}
\right.
\end{equation}
\end{proposition}

\begin{proof}
Un point $\mathbf{x} \in \mathbb{S}_a^2$ a pour coordonnées $(\lambda, \theta)$ en longitude-latitude associée au pôle Nord et $(\lambda', \theta')$ en coordinnées latitude-longitude associée avec un pôle déplacé en $P$. Le lien entre ces coordonnées se fait par rotation successives.
En considérant les rotations liées au changement de pôle Nord, on a
\begin{align}
\begin{bmatrix}
\cos \theta' \cos \lambda' \\ \cos \theta' \sin \lambda' \\ \sin \theta'
\end{bmatrix} & = 
\begin{bmatrix}
\cos (\theta_P - \pi/2) & 0 & \sin (\theta_p - \pi/2) \\
0 & 1 & 0 \\
- \sin (\theta_P - \pi/2 ) & 0 & \cos (\theta_P - \pi/2)
\end{bmatrix}
\begin{bmatrix}
\cos \lambda_P & \sin \lambda_P & 0 \\
- \sin \lambda_P & \cos \lambda_P & 0 \\
0 & 0 & 1 
\end{bmatrix}
\begin{bmatrix}
\cos \theta \cos \lambda \\ \cos \theta \sin \lambda \\ \sin \theta
\end{bmatrix} \\
& = \begin{bmatrix}
\sin \theta_P \cos \lambda_P & \sin \theta_P \sin \lambda_P & - \cos \theta_P \\
- \sin \lambda_P & \cos \lambda_P & 0 \\
\cos \theta_P \cos \lambda_P & \cos \theta_P \sin \lambda_P & \sin \theta_P
\end{bmatrix}
\begin{bmatrix}
\cos \theta \cos \lambda \\ \cos \theta \sin \lambda \\ \sin \theta
\end{bmatrix}.
\label{eq:chgmt_coord_proof1}
\end{align}
La seconde ligne de \eqref{eq:chgmt_coord_proof1} donne
\begin{align*}
\cos \theta' \in \lambda'  & = - \sin \lambda_P \cos \theta \cos \lambda + \cos \lambda_P \cos \theta \sin \lambda \\
	& = \cos \theta ( \cos \lambda_P \sin \lambda - \sin \lambda_P \cos \lambda) \\
	& = \cos \theta \sin (\lambda - \lambda_P)
\end{align*}
ce qui nous donne l'équation :
\begin{equation}
\cos \theta' \sin \lambda' = \cos \theta \sin (\lambda - \lambda_P).
\label{eq:chgmt_coord_proof2}
\end{equation}
De la même manière, la seconde ligne de \eqref{eq:chgmt_coord_proof1} permet d'obtenir
\begin{equation}
\sin \theta' = \cos \theta_P \cos \theta \cos (\lambda - \lambda_P) + \sin \theta_P \sin \theta .
\label{eq:chgmt_coord_proof3}
\end{equation}
D'après la première ligne de \eqref{eq:chgmt_coord_proof1} :
\begin{align*}
\cos \theta' \cos \lambda' & = \sin \theta_P \cos \lambda_P \cos \theta \cos \lambda + \sin \theta_P \sin \lambda_P \cos \theta \sin \lambda - \cos \theta_P \sin \theta \\
	& = \sin \theta_P \cos \theta \cos ( \lambda - \lambda_P) - \cos \theta_P \sin \theta \\
	& = \sin \theta_P \dfrac{\sin \theta' - \sin \theta_P \sin \theta}{\cos \theta_P} - \cos \theta_P \sin \theta \text{ d'après \eqref{eq:chgmt_coord_proof3} } \\
	& = \dfrac{\sin \theta_P \sin \theta' - \sin \theta}{\cos \theta_P}
\end{align*}
D'où une troisième équation
\begin{equation}
\sin \theta = \sin \theta_P \sin \theta' - \cos \theta' \cos \lambda' \cos \theta_P .
\label{eq:chgmt_coord_proof4}
\end{equation}
Les équations démontrées sont les suivantes :
\begin{equation}
\label{eq:coord_rot}
\left\lbrace 
\begin{array}{rcl}
\sin ( \theta ) & = & \sin( \theta_P) \sin( \theta') - cos( \theta_P) cos( \theta') cos( \lambda' ) \\
\sin( \theta' ) & = & \sin( \theta) \sin(\theta_P) + cos( \theta ) cos( \theta_P) cos( \lambda - \lambda_P ) \\
cos( \theta ) \sin( \lambda - \lambda_P) & = & cos( \theta' ) \sin( \lambda' )
\end{array}
\right.
\end{equation}.
En utilisant (\ref{eq:coord_rot}.b), la formule suivante est immédiate :
\begin{equation}
\theta' = \arcsin \left[ \sin( \theta) \sin(\theta_P) + cos( \theta ) cos( \theta_P) cos( \lambda - \lambda_P ) \right] .
\end{equation}
De plus, (\ref{eq:coord_rot}.a) et (\ref{eq:coord_rot}.c) donnent :
\begin{equation}
\left\lbrace 
\begin{array}{rcl}
\cos( \theta ) \sin( \lambda - \lambda_P) & = & \cos( \theta' ) \sin( \lambda' ) \\
\cos( \theta ) \cos( \lambda - \lambda_P) & = & \frac{\sin( \theta' ) \sin ( \theta_P ) - \sin( \theta )}{\cos( \theta_P)}
\end{array}
\right. .
\end{equation}.
Or :
\begin{equation*}
\begin{array}{rcl}
\cos( \theta ) \cos( \lambda - \lambda_P) & = & \dfrac{\sin( \theta' ) \sin ( \theta_P ) - \sin( \theta )}{\cos( \theta_P)} \\
 & = & \dfrac{\sin( \theta) (\sin^2 ( \theta_P) -1 )}{\cos( \theta_P)} + \cos( \theta ) \cos( \lambda- \lambda_P) \sin( \theta_P)\\
 & = & \cos ( \theta) \cos( \lambda - \lambda_P) \sin( \theta_P ) - \sin( \theta) \cos ( \theta_P )
\end{array} .
\end{equation*}
Dès lors, en remarquant que :
\begin{equation}
\tan ( \lambda' ) =  \dfrac{\cos( \theta' ) \sin(  \lambda' ) }{\cos( \theta' ) \cos(  \lambda' )}
\end{equation}
on a le changement de coordonnées dans un premier sens :
\begin{equation}
\left\lbrace 
\begin{array}{rcl}
\theta' & = & \arcsin \left[ \sin( \theta) \sin(\theta_P) + \cos( \theta ) \cos( \theta_P) \cos( \lambda - \lambda_P ) \right] \\
\lambda' & = & \arctan \left[ \dfrac{\cos ( \theta) \sin( \lambda - \lambda_P)}{\cos( \theta) \cos( \lambda - \lambda_P) \sin( \theta_P) - \sin( \theta) \cos( \theta_P)} \right]
\end{array}
\right.
\end{equation}
Inversement et par une démonstration similaire, on a :
\begin{equation}
\left\lbrace 
\begin{array}{rcl}
\theta & = & \arcsin \left[ \sin( \theta') \sin(\theta_P) - \cos( \theta' ) \cos( \theta_P) \cos( \lambda' ) \right] \\
\lambda & = & \lambda_P + \arctan \left[ \dfrac{\cos ( \theta') \sin( \lambda ')}{\sin( \theta') \cos( \theta_P) + \cos ( \theta') \cos( \lambda') \sin ( \theta_P)} \right]
\end{array}
\right. .
\end{equation}
\end{proof}

\begin{proposition}
La solution de l'équation d'advection sur la sphère \eqref{eq:advection_sphere} avec
\begin{equation}
\mathbf{c}(\mathbf{x}) = \mathbf{c}(\lambda,\theta) = u_0 \cos \theta \mathbf{e}_{\lambda}
\end{equation}
est donnée pour $t \geq 0$ par
\begin{equation}
h(\mathbf{x}, t ) = h(\lambda, \theta, t ) = h_0(\lambda- \omega_s t , \theta)
\end{equation}
avec $a \omega_s = u_0$ et $\mathbf{x}$ un point de la sphère $\mathbb{S}_a^2$ de coordonnées longitude-latitude $(\lambda, \theta)$.
Cette dernière solution s'écrit aussi
\begin{equation}
h(\mathbf{x},t) = h_0(R_{-t} \mathbf{x})
\end{equation}
où $R_{-t}$ est la matrice de rotation
\begin{equation}
R_{-t} = \begin{pmatrix}
\cos (- \omega_s t) & - \sin (- \omega_s t) & 0 \\
\sin (- \omega_s t) & \cos (- \omega_s t)   & 0 \\
0 & 0 & 1
\end{pmatrix} .
\end{equation}
\end{proposition}

\begin{proof}
On souhaite résoudre cette équation par la méthode des caractéristiques. Soit $X : t \in \mathbb{R}^+ \mapsto X(t)=(\lambda(t), \theta(t)) \in \mathbb{S}_a^2$ solution de 
\begin{equation}
\left\lbrace
\begin{array}{rcl}
\dfrac{dX}{dt} & = & \mathbf{c}(X(t)) \\
X(0) & = & \mathbf{x}_0 = (\lambda_0, \theta_0)
\end{array}
\right.
\label{eq:cauchy_sphere1}
\end{equation}
D'après le théorème de Cauchy-Lipschitz, il existe une telle courbe $X$ solution maximale.

Si $h$ est solution de \eqref{eq:advection_sphere}, $h$ est constante le long de $X$, en effet
\begin{align*}
\dfrac{dh}{dt}(X(t),t) & = \dfrac{\partial h}{\partial t} (X(t),t) + \dfrac{d X}{dt}(t) \cdot \nabla_T h(X(t),t) \\
& = \dfrac{\partial h}{\partial t} (X(t),t) + \mathbf{c}(X(t)) \cdot \nabla_T h(X(t),t) \\
& = 0.
\end{align*}
En exprimant $X$ en coordonnée latitude-longitude, on obtient la formule
\begin{equation}
\dfrac{dX}{dt} = a \cos \theta \dfrac{d \lambda}{dt} \mathbf{e}_{\lambda} + a \dfrac{d \theta}{d t} \mathbf{e}_{\theta}
\end{equation}
ainsi, en identifiant les termes dans le problème de Cauchy, on a
\begin{equation}
\left\lbrace
\begin{array}{rcl}
\dfrac{d \lambda}{d t} & = & \omega_s \\
\dfrac{d \theta}{d t}  & = & 0
\end{array}
\right.
\end{equation}
d'où on a directement
\begin{equation}
\left\lbrace
\begin{array}{rcl}
\lambda(t) & = & \omega_s t + \lambda_0 \\
\theta(t)  & = & \theta_0
\end{array}
\right. .
\end{equation}
$h$ est constante le long de sa caractéristique, donc
\begin{equation}
h(\lambda, \theta, t) = h_0(\lambda_0 , \theta_0 ) = h_0(\lambda - \omega_s t, \theta ). 
\end{equation}
\end{proof}

Si $(\lambda_P, \theta_P) = (\pi, \pi / 2 - \alpha)$, alors la matrice de rotation pour passer d'un système de coordonnées à l'autre est
\begin{equation}
P_{\alpha} = \begin{pmatrix}
- \cos \alpha & 0 & - \sin \alpha \\
0 & -1 & 0 \\
- \sin \alpha & 0 & \cos \alpha
\end{pmatrix} .
\end{equation}
on a alors le théorème suivant

\begin{theoreme}
La solution de l'équation \eqref{eq:advection_sphere} avec
\begin{equation}
\mathbf{c}(\mathbf{x}) = \mathbf{c}(\lambda, \theta) = u_0 \left( \cos \theta \cos \alpha + \sin \theta \cos \lambda \sin \alpha \right) \mathbf{e}_{\lambda} - u_0 \sin \lambda \sin \alpha \mathbf{e}_{\theta}
\label{eq:rot_solide_1}
\end{equation}
est donnée pour $t \geq 0$ par
\begin{equation}
h(\mathbf{x}, t ) = h_0(P_{\alpha}^{-1}R_{-t}P_{\alpha} \mathbf{x})
\end{equation}
où $R_{-t}$ est la matrice de rotation
\begin{equation}
R_{-t} = \begin{pmatrix}
\cos (- \omega_s t) & - \sin (- \omega_s t) & 0 \\
\sin (- \omega_s t) & \cos (- \omega_s t)   & 0 \\
0 & 0 & 1
\end{pmatrix}
\end{equation}
et $\mathbf{x}$ est un point de la sphère $\mathbb{S}_a^2$.
\end{theoreme}

\begin{proof}
La rotation $P_{\alpha}$ est inversible donc $\mathbf{x} \mapsto P_{\alpha} \mathbf{x}$ réalise une bijection de $\mathbb{S}_a^2$ dans $\mathbb{S}_a^2$.

Soit $g : (\mathbf{x},t) \in \mathbb{S}_a^2 \times \mathbb{R}^+ \mapsto g(\mathbf{x},t)$ la solution de 
\begin{equation}
\left\lbrace
\begin{array}{rcl}
\dfrac{\partial g}{\partial t} + \mathbf{c}_g \cdot \nabla_T g & = & 0\\
g(\mathbf{x},0) & = & h_0(P_{\alpha}^{-1}\mathbf{x})
\end{array}
\right.
\label{eq:sol_g_proof}
\end{equation}
alors d'après la proposition précédente, en tout point de la sphère, on a
\begin{equation}
g(\mathbf{x},t) = h_0(R_{-t} P_{\alpha}^{-1}\mathbf{x}).
\end{equation}

Si on pose $h(\mathbf{x},t) = g(P_{\alpha} \mathbf{x} ,t)$, alors $h$ est solution de \eqref{eq:advection_sphere} avec \eqref{eq:rot_solide_1}, en effet
\begin{align*}
\dfrac{\partial h}{\partial t} (\mathbf{x},t) + \mathbf{c}(\mathbf{x}) \cdot \nabla_T h(\mathbf{x},t) & = \dfrac{\partial g}{\partial t} (P_{\alpha}\mathbf{x},t) + P_{\alpha} \mathbf{c}(\mathbf{x}) \cdot \nabla_T g (P_{\alpha}\mathbf{x},t) \\
	& = \dfrac{\partial g}{\partial t} (P_{\alpha}\mathbf{x},t) + P\mathbf{c}_g(\mathbf{x}) \cdot \nabla_T g (P_{\alpha}\mathbf{x},t) \\
	& = \dfrac{\partial g}{\partial t} (P_{\alpha}\mathbf{x},t) + u_0 \cos \theta \mathbf{e}_{\lambda} \cdot \nabla_T g (P_{\alpha}\mathbf{x},t) \\
	& = 0
\end{align*}
car $g$ est solution du problème \eqref{eq:sol_g_proof}.
De plus, on a bien $h(\mathbf{x},0) = g(P_{\alpha} \mathbf{x} ,0) = h_0(\mathbf{x})$, donc en tout point $\mathbf{x} \in \mathbb{S}_a^2$, on a
\begin{align*}
h(\mathbf{x},t) & = g(P_{\alpha} \mathbf{x}, t) \\
	& = g_0(R_{-t} P_{\alpha} \mathbf{x} ) \\
	& = h_0(P_{\alpha}^{-1}R_{-t}P_{\alpha} \mathbf{x}).
\end{align*}
Et le théorème est bien démontré.
\end{proof}

Le premier test évoqué dans \cite{Williamson1992} consite à comparer la solution numérique obtenue pour la résolution de \eqref{eq:advection_sphere} avec le champ de vitesse $\mathbf{c}$ donné par \eqref{eq:rot_solide_1} et la donnée initiale donnée par le Bump suivant :
\begin{equation}
h_0(\lambda, \theta) = \left\lbrace
\begin{array}{ccl}
(h_0/2) (1 + \cos (\pi r/R) ) & \text{ si } & r<R \\
0 & \text{ si } & r \geq R
\end{array}
\right.
\label{eq:initial_solid_body}
\end{equation}
avec $h_0 = 1000 \si{m}$, $R=a/3$ et $r$ est la distance 
\begin{equation}
r = a \arccos \left( \sin \theta_C \sin \theta + \cos \theta_C \cos \theta \cos (\lambda - \lambda_C) \right),
\end{equation}
$(\lambda_C, \theta_C) = (3 \pi / 2 , 0)$ est la position initiale du Bump. Il s'agit d'une condition initiale de classe $\mathcal{C}^1$. Des tests existent avec des solutions initiales moins régulières, en particulier \cite{Nair2010}, mais nous ne nous concentrons pas sur ce type de problèmes ici.















\subsection{Vortex stationnaire}

\subsection{Vortex en rotation}





\section{Equations de conservation non linéaire}

\subsection{Généralités}

\subsection{Test équatorial périodique}

\subsection{Test stationnaire}

\subsection{Solution stationnaire dans une cloche}

\subsection{Solution confinée}