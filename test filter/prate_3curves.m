clc; clear all; close all;

radius=6371220;
N=[8 16 32 64 128 256];
dx=2*pi*radius./(4*N);
% e1=[2.0963e-2 1.5863e-2 4.9861e-4 1.2394e-6 1.7658e-9 9.5777e-12];
% e2=[2.6194e-2 2.3535e-2 7.8589e-4 1.9919e-6 3.6229e-9 1.1097e-10];
% e3=[4.4752e-2 6.6690e-2 2.9727e-3 8.5586e-6 7.6882e-8 4.5050e-9];

% e1=[8.5678e-5 2.4618e-7 1.0687e-9 2.2554e-11 6.6050e-13 2.0170e-14];
% e2=[1.3701e-4 3.8854e-7 4.7661e-9 1.8082e-10 7.4291e-12 3.1657e-13];
% e3=[4.5859e-4 1.5631e-6 8.6449e-8 4.4339e-9 2.5436e-10 1.5149e-11];

% e1=[1.3632e-7 5.7406e-10 1.1462e-11 3.2764e-13 1.0064e-14 3.3383e-16];
% e2=[3.1191e-7 1.1452e-9 3.8740e-11 1.7535e-12 7.8953e-14 3.5222e-15];
% e3=[2.4651e-6 8.4471e-9 6.1885e-10 3.9985e-11 2.5708e-12 1.6163e-13];

% e1=[1.1315e-3 2.8629e-4 7.1814e-5 1.7973e-5 4.4950e-6 1.1239e-6];
% e2=[1.1413e-3 2.8525e-4 7.1189e-5 1.7773e-5 4.4398e-6 1.1095e-6];
% e3=[1.6770e-3 4.3815e-4 1.1085e-4 2.7766e-5 6.9449e-6 1.7366e-6];

% e1=[2.7388e-5 1.7510e-6 1.1017e-7 6.9021e-9 4.3178e-10 2.6997e-11];
% e2=[3.2726e-5 2.1184e-6 1.3355e-7 8.3682e-9 5.2347e-10 3.2729e-11];
% e3=[7.0509e-5 4.7655e-6 3.0421e-7 1.9135e-8 1.2152e-9 7.8438e-11];

% e1=[1.4406e-7 1.7276e-9 3.4635e-11 7.2587e-13 1.6649e-14 4.2059e-16];
% e2=[2.6916e-7 2.3185e-9 5.3170e-11 1.8451e-12 7.9089e-14 3.5058e-15];
% e3=[1.4897e-6 1.1606e-8 6.2056e-10 3.9954e-11 2.5740e-12 1.6185e-13];

% e1=[2.3593e-6 3.8948e-8 6.1857e-10 9.7778e-12 1.5687e-13 2.6074e-15];
% e2=[3.1134e-6 5.1625e-8 8.1620e-10 1.2901e-11 2.1650e-13 4.8565e-15];
% e3=[8.4490e-6 1.7513e-7 3.1830e-9 5.2009e-11 2.5681e-12 1.6051e-13];

% e1=[4.1729e-7 1.8887e-9 1.5794e-11 3.3668e-13 9.8453e-15 3.2273e-16];
% e2=[7.1204e-7 2.9434e-9 4.0885e-11 1.7931e-12 8.0642e-14 3.5956e-15];
% e3=[5.0873e-6 2.1887e-8 6.2254e-10 4.0140e-11 2.5643e-12 1.6110e-13];

% e1=[1.0240e-3 2.7093e-4 6.8850e-5 1.7281e-5 4.3243e-6 1.0813e-6];
% e2=[1.1618e-3 3.1478e-4 8.0629e-5 2.0292e-5 5.0824e-6 1.2713e-6];
% e3=[2.0555e-3 6.0930e-4 1.5839e-4 4.0028e-5 1.0032e-5 2.5107e-6];

% e1=[1.2011e-4 8.8131e-6 5.7635e-7 3.6425e-8 2.2843e-9 1.7294e-10];
% e2=[1.8540e-4 1.4012e-5 9.1438e-7 5.7783e-8 3.6227e-9 2.2664e-10];
% e3=[5.0874e-4 3.8547e-5 2.5085e-6 1.5827e-7 9.9148e-9 6.2003e-10];

% e1=[3.2353e-5 6.2894e-7 1.0414e-8 1.6545e-10 2.6061e-12 4.1070e-14];
% e2=[4.8855e-5 9.8216e-7 1.6319e-8 2.5922e-10 4.0730e-12 6.4211e-14];
% e3=[1.3666e-4 2.7632e-6 4.5857e-8 7.2730e-10 1.1407e-11 3.1453e-13];

% e1=[9.0819e-6 4.7678e-8 2.1613e-10 1.4911e-12 2.5865e-14 7.2834e-16];
% e2=[1.3810e-5 7.4343e-8 3.3205e-10 4.5803e-12 1.8889e-13 8.2202e-15];
% e3=[3.8683e-5 2.1328e-7 1.5035e-9 8.5273e-11 5.1288e-12 3.1436e-13];

% e1=[2.9329e-6 5.0318e-9 3.3001e-11 8.0529e-13 2.3704e-14 7.4816e-16];
% e2=[4.2382e-6 7.6035e-9 1.0816e-10 4.3773e-12 1.8693e-13 8.1283e-15];
% e3=[1.1385e-5 3.0081e-8 1.4987e-9 8.5972e-11 5.1722e-12 3.1641e-13];

e1=[1.3789e-6 1.2375e-8 4.2263e-10 8.0485e-12 1.4279e-13 2.6220e-15];
e2=[2.0991e-6 1.7824e-8 6.3871e-10 1.2526e-11 2.6739e-13 8.6607e-15];
e3=[8.4087e-6 4.4652e-8 1.7368e-9 8.6912e-11 5.2007e-12 3.1741e-13];

ldx=log10(dx);
le1=log10(e1);
le2=log10(e2);
le3=log10(e3);

%% plot 1
figure(11); 
%% curve 1
hl1=plot(ldx,le1,'ok');
set(hl1,'LineWidth',2.0);
set(hl1,'MarkerSize',10);
set(hl1,'MarkerEdgeColor','k');

hold on;
[a1,b1]=polyfit(ldx,le1,1);
tt=linspace(min(ldx),max(ldx),10);
lsq1=a1(2)+a1(1)*tt;
% %% courbes...
%hlf1=plot(tt,lsq1,'-r');
hlf1=plot(tt,lsq1,':k');
set(hlf1,'LineWidth',2.0);


%% curve 2
hl1=plot(ldx,le2,'ok');
set(hl1,'LineWidth',2.0);
set(hl1,'MarkerSize',10);
set(hl1,'MarkerEdgeColor','k');

hold on;
[a2,b1]=polyfit(ldx,le2,1);
tt=linspace(min(ldx),max(ldx),10);
lsq1=a2(2)+a2(1)*tt;
% %% courbes...
%hlf2=plot(tt,lsq1,'-b');
hlf2=plot(tt,lsq1,'--k');
set(hlf2,'LineWidth',2.0);

%% curve 3
hl1=plot(ldx,le3,'ok');
set(hl1,'LineWidth',2.0);
set(hl1,'MarkerSize',10);
set(hl1,'MarkerEdgeColor','k');

hold on;
[a3,b1]=polyfit(ldx,le3,1);
tt=linspace(min(ldx),max(ldx),10);
lsq1=a3(2)+a3(1)*tt;
% %% courbes...
%hlf3=plot(tt,lsq1,'-g');
hlf3=plot(tt,lsq1,'-k');
set(hlf3,'LineWidth',2.0);

ha=gca;
xa=get(gca,'Xlabel');
set(ha,'Xgrid','on');
set(xa,'String','Log_{10}(\Delta)');
set (xa,'FontName','Calibri');
set(xa,'FontSize',12);

% ylabel
ha=gca;
ya=get(gca,'Ylabel');
set(ha,'Ygrid','on');
set(ya,'String','Log_{10}(error)');
set (ya,'FontName','Calibri');
set(ya,'FontSize',12);

%% legend
legend([hlf1,hlf2,hlf3],{['norm 1 - slope = ' num2str(a1(1))],['norm 2 - slope = ' num2str(a2(1))],['norm \infty - slope = ' num2str(a3(1))]},'Location','SouthEast')
