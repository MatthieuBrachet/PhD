\section{Benchmarks}

***** INTRODUIRE LES DIFFERENTS SYSTEMES DE COORDONNEES *****

\section{Vortex Stationnaire}

L'idée de ce test est de former deux tourbillons diamétralements opposés à des positions données sur la surface de la sphère, il s'agit donc d'un test de déformation sans déplacement. Ce dernier est proposé dans un article de Nair R. et al. en 2001 \cite{Nair2001} et ainsi qu'un second \cite{Nair1999}.
La solution exacte est donnée directement sur la surface de la sphère :

\begin{equation}
\phi ( \lambda' , \theta', t ) = 1 - \tanh \left[ \dfrac{\rho}{\gamma} \sin ( \lambda' - \omega_r t ) \right]
\label{NM_exacte}
\end{equation}

où $( \lambda' , \theta' )$ correspond au système latitude longitude autour de l'axe $(N'S')$ et $t>0$ est la variable de temps. Cette fonction $\psi$ est strictement positive et infiniement dérivable. $\gamma$ est une constante fixée déterminant la raideur de la solution (nous avons choisit $\gamma = 5$). De plus $\rho = \rho_0 \cos ( \theta' )$ avec $\rho_0$ une constante choisie égale à $3$.

Si $v_0 = 2 \pi R / T$ où $T$ est le temps total (ici $12$ jours) on peut définir la vitesse tangentielle mise à l'échelle :

\begin{equation}
  V = v_0 \dfrac{3 \sqrt{3} }{2} sech^2 ( \rho ) tanh ( \rho )
  \label{vitesse_tangentielle}
\end{equation} 

Cependant, dans ce cas, la vitesse angulaire varie avec la distance la séparant du centre du vortex. $\omega_r$ est donné par la formule suivante :

\begin{equation}
   \omega_r ( \theta' ) = \left\{ 
   \begin{array}{ll}
      V/( R \rho ) & \text{ si } \rho \neq 0 \\
      0 & \text{ sinon }
   \end{array}
   \right.
\label{vitesse_angulaire}
\end{equation}

Cette solution exacte au problème permet aussi de donner la condition initiale. De plus, pour que le problème soit complètement posé, on doit fixer $\mathbf{c} = ( c_{\lambda, r} , c_{\theta, r})^T$ dans la base $(\lambda, \theta)$ : 


\begin{equation}
c_{\lambda, r} = R \omega_r ( \theta' ) \left[ \sin \theta_p \cos \theta - \cos \theta_p \cos ( \lambda - \lambda_p ) \sin \theta \right]
\label{vitesse_lambda_mach}
\end{equation}
\begin{equation}
c_{\theta, r} = R \omega_r ( \theta' ) \left[ \cos \theta_p \sin ( \lambda - \lambda_p ) \right]
\label{vitesse_theta_mach}
\end{equation}

$P = ( \lambda_P, \theta_P)$ étant la position de l'un des tourbillons. On remarque que dans ce test, les vitesses de $\mathbf{c}$ données par \eqref{vitesse_lambda_mach} et \eqref{vitesse_theta_mach}.

\subsection{Test de Nair et Jablonowski}

Le test construit par Nair R. D. et Jablonowski C. dans \cite{Nair2008} combine à la fois le test de déformation de Nair R. D. et Machenhauer B. \cite{Nair2001} évoqué ci-dessus et celui du corps solide en rotation présent dans \cite{Nair1999} ou dans \cite{Williamson1994}. De plus, ce test a déjà été présenté dans un article précédent \cite{Croisille2013}. 

L'idée du test du corps solide en rotation est de déplacer sans déformer une fonction autour de la sphère. Dans ce cas, on a $\mathbf{c} = \left( c_{\lambda, s}, c_{\theta, s} \right)^T$ donné par :

\begin{equation}
c_{\lambda, s} = R \omega_s \left( \sin \theta_p \cos \theta - \cos \theta_p \cos ( \lambda - \lambda_p ) \sin \theta \right)
\label{vitesse_lambda_bump}
\end{equation}
\begin{equation}
c_{\theta, s} = - R \omega_s \cos \theta_p \sin ( \lambda - \lambda_p )
\label{vitesse_theta_bump}
\end{equation}

où $\omega_s = v_0 / R = 2 \pi / T $ et $( \lambda_p, \theta_p$ )  est la position de $P$ un point de la sphère tel que $(OP)$ définisse un axe autour duquel doit tourner la condition initiale.

L'objectif ici est de faire tourner un vortex autour de la sphère. La position du centre de ce vortex varie ainsi a cours du temps. Si cette dernière est notée $( \lambda_c (t), \theta_c (t))$, alors la vitesse de formation du vortex est :

\begin{equation}
c_{\lambda, r}(t) = R \omega_r ( \theta' ) \left[ \sin \theta_c (t) \cos \theta - \cos \theta_c (t) \cos ( \lambda - \lambda_c (t) ) \sin \theta \right]
\label{vitesse_lambda_vortex}
\end{equation}
\begin{equation}
c_{\theta, r}(t) = R \omega_r ( \theta' ) \left[ \cos \theta_c (t) \sin ( \lambda - \lambda_c (t) ) \right]
\label{vitesse_theta_vortex}
\end{equation}

Avec $\theta'$ donné par les coordonnées pivotées sur la sphère de p\^ole Nord $ ( \lambda_c (t), \theta_c (t) )$ ainsi que les formules \eqref{vitesse_tangentielle} et \eqref{vitesse_angulaire}.

La position du vortex est donnée dans les coordonnées $( \lambda', \theta')$ pivotées sur l'axe de rotation du vortex par : $\lambda_c ' (t) = \lambda' _0 + \omega_s t $ et $\theta_c ' (t) = \theta_0 '$ avec $\lambda_0$ et $\theta_0$ la position initiale du vortex.

Dans ce contexte, on peut obtenir $\mathbf{c} = ( c_{\lambda}, c_{\theta} )^T $ par :

\begin{equation}
  \left\{
  \begin{array}{rcl}
    c_{\lambda} & = & c_{\lambda,s} + c_{\lambda,r} (t) \\
    c_{\theta} & = & c_{\theta,s} + c_{\theta,r} (t)
  \end{array}
  \right.
\end{equation}

La condition initiale étant donnée par la formule TBA...


















\begin{figure}[H]
\includegraphics[scale=0.3]{04-Nov-2015ref_7362724687_snapshot_test_2_nday_0.png}
\includegraphics[scale=0.3]{04-Nov-2015ref_7362724281_snapshot_test_2_nday_3.png}

\includegraphics[scale=0.3]{04-Nov-2015ref_7362724321_snapshot_test_2_nday_6.png}
\includegraphics[scale=0.3]{04-Nov-2015ref_736272438_snapshot_test_2_nday_9.png}

\includegraphics[scale=0.3]{04-Nov-2015ref_7362724445_snapshot_test_2_nday_12.png}
\caption{Projection de la solution approchée au bout de 0, 3, 6, 9 et 12 jours pour le test de Nair et Jablonowski \cite{Nair2008}. $N=31$; $CFL = 0.7$; $\alpha = 3 \pi / 4$}
\label{SNAPSHOT}
\end{figure}



\begin{figure}[H]
\includegraphics[scale=0.3]{05-Nov-2015ref_7362736695_normerreur_test_2.png}
\includegraphics[scale=0.3]{05-Nov-2015ref_7362737739_normerreur_test_2.png}
\label{erreur_cfl=0.05}
\caption{courbe d'erreur $N=35$; $cfl=0.05$; $\alpha = \pi / 4$ (gauche) et $\alpha = 0$ (droite) pour le test de Nair et Jablonowski \cite{Nair2008}}
\end{figure}



\begin{figure}[H]
\includegraphics[scale=0.3]{09-Nov-2015ref_7362776620_normerreur_test_2.png}
\includegraphics[scale=0.3]{06-Nov-2015ref_7362745425_normerreur_test_2.png}
\label{erreur_cfl=0.5}
\caption{courbe d'erreur $N=35$; $cfl=0.5$; $\alpha = \pi / 4$ (gauche) et $\alpha = 0$ (droite) pour le test de Nair et Jablonowski \cite{Nair2008}}
\end{figure}



\begin{figure}
\begin{tabular}{c||cc|cc|cc}
$N$ & $max_n |e_1^n|$ & ordre  & $max_n |e_2^n|$ & ordre  & $max_n |e_{\infty}^n|$ & ordre \\
\hline
\hline
$40$ & $2.7609 (-3)$ & -  & $9.7386 (-3)$ & - & $5.4808 (-2)$  & - \\
\hline 
$50$ & $1.276 (-3)$ & $3.5364$ & $5.0160 (-3)$ & $3.0399$ & $3.2035 (-2)$ & $2.4605$ \\
\hline
$60$ & $6.2957 (-4)$ & $3.9456$ & $2.6157 (-3)$ & $3.6365$ & $1.8218 (-2)$ & $3.1523$ \\
\hline
$80$ & $1.9603 (-4) $ & $4.1145$ & $8.3722 (-4)$ & $4.0173$ & $6.0931 (-3)$ & $3.8623$ \\
\hline
$100$ & $8.0399 (-5)$ & $4.0389$ & $3.4524 (-4)$ & $4.0143$ & $2.6514 (-3)$ & $3.7706$\\
\hline
$150$ & $1.5656 (-5)$ & $4.0684$ & $6.9199 (-5)$ & $3.9966$ & $5.8082 (-4)$ & $3.7756$
\end{tabular}
\caption{Analyse de convergence de Nair et Jablonowski \cite{Nair2008} ; $cfl = 0.7$ ; $\alpha = \pi /4$}
\end{figure}


\subsection{Test sur les harmoniques sphériques}
