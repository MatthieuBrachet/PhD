%% LyX 1.6.9 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.
\documentclass[oneside,english]{amsart}
%\documentclass[oneside,english]{article}
\usepackage[T1]{fontenc}
\usepackage[latin9]{inputenc}
\usepackage{amsmath,amssymb,graphicx}
\usepackage{amsthm}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{epsfig}
\usepackage{color}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\graphicspath{{./Images/}}
%usepackage[dvips]{color}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\setlength{\textheight}{210mm}
\setlength{\textwidth}{154mm}
%\setlength{\headsep}{0mm}
%\setlength{\hoffset}{0mm}
\setlength{\oddsidemargin}{-0mm}
\setlength{\evensidemargin}{-0mm}
%\setlength{\topmargin}{30mm}
\makeatletter
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\newcommand{\cal}{\mathcal}
\newcommand{\beq}{\begin{equation}}
\newcommand{\eeq}{\end{equation}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\def\sinc{\mathop{\rm sinc}\nolimits}  
\def\cal{\mathop{\rm cal}\nolimits}  
\def\CFL{\mathop{\rm CFL}\nolimits}  
\def\ex{\mathop{\rm ex}\nolimits}  
\def\atan{\mathop{\rm atan}\nolimits}  
\def\sech{\mathop{\rm sech}\nolimits}  
\def\tanh{\mathop{\rm tanh}\nolimits}  
\def\div{\mathop{\rm div}\nolimits}  
\def\days{\mathop{\rm days}\nolimits}  
\def\Re{\mathop{\rm Re}\nolimits}  
\newcommand{\bgrad}{\mbox{\boldmath$\nabla$}}
\newcommand{\bnabla}{\mbox{\boldmath$\nabla$}}
\newcommand{\bF}{\mbox{\boldmath$F$}}
\newcommand{\bM}{\mbox{\boldmath$M$}}
\newcommand{\bg}{\mbox{\boldmath$g$}}
\newcommand{\bq}{\mbox{\boldmath$q$}}
\newcommand{\bx}{\mbox{\boldmath$x$}}
\newcommand{\bc}{\mbox{\boldmath$c$}}
\newcommand{\be}{\mbox{\boldmath$e$}}
\newcommand{\bn}{\mbox{\boldmath$n$}}
\newcommand{\bu}{\mbox{\boldmath$u$}}
\newcommand{\bv}{\mbox{\boldmath$v$}}
\newcommand{\bs}{\mbox{\boldmath$s$}}
\newcommand{\bi}{\mbox{\boldmath$i$}}
\newcommand{\bj}{\mbox{\boldmath$j$}}
\newcommand{\bk}{\mbox{\boldmath$k$}}
\newcommand{\bvarphi}{\mbox{\boldmath$\varphi$}}
\newcommand{\bomega}{\mbox{\boldmath$\omega$}}
\newcommand{\bpsi}{\mbox{\boldmath$\psi$}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% ** PERSONAL NEWTHEOREMS
%\newtheorem{prop}{Proposition}[chapter]
%\newtheorem{prop}{Proposition}[section]
%\newtheorem{prop}[thm]{Proposition}
%\newtheorem{proposition}{Proposition}[section]
%\newtheorem{thm}{Theorem}[section]
%\newtheorem{theorem}{Theorem}[section]
%\newtheorem{theorem}{Theorem}[chapter]
%\newtheorem{algo}{Algorithm}
\newtheorem{thm}{Theorem}[section]
%\newtheorem{thm}{Th\'eor\`eme}[chapter]
\theoremstyle{definition}
\newtheorem{defi}[thm]{Definition}
%\newtheorem{coro}[thm]{Corollaire}
%\newtheorem{lemma}[thm]{Lemme}
%\newtheorem{claim}[thm]{Claim}
%\newtheorem{example}[thm]{Exemple}
%\newtheorem{formula}[thm]{Formule}
\theoremstyle{remark}
\newtheorem{remark}[thm]{Remark}
%\newtheorem{prop}[thm]{Proposition}
%\newtheorem{fig}[thm]{chapter}
%\newtheorem{acknowledgement}{Acknoledgement}[section]
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% LyX specific LaTeX commands.
%% Because html converters don't know tabularnewline
%% \providecommand{\tabularnewline}{\\}
%% A simple dot to overcome graphicx limitations
\newcommand{\lyxdot}{.}


\makeatother

\usepackage{babel}

\begin{document}

\title[Compact Schemes for propagation problems on the sephre]{
Using a compact scheme for propagation problems 
on the sphere}

\begin{abstract}
New abstract: In \cite{Croisille-10} a methodology to
for compact differencing on a sphere
has been introduced. In this paper we show that
this approach permits to efficiently perform classical test cases
of the litterature in climatology without
resorting to conservative upwind schemes.
Our scheme is basically centered. The numerical viscosity
is added by mean of a filtering along great circles directions.
\end{abstract}

\author{M. Brachet and J.-P. Croisille\dag\ddag}
\address{\dag Universit\'e de Lorraine, D\'epartement de Math\'ematiques, F-57045 Metz, France\\
\ddag C.N.R.S., Institut Elie Cartan de Lorraine, UMR 7502, F-57045 Metz, France}
\email{matthieu.brachet@univ-lorraine.fr, jean-pierre.croisille@univ-lorraine.fr}
\date{October 20, 2016}
\maketitle

{\sl Keywords: Cubed-Sphere grid - Compact finite difference scheme - 
Hermitian derivative - Vortex propagation}

%% *** INTRODUCTION ***************************************************************************

\section{Introduction}
\label{sec:1}
In this paper, we continue the development
of the compact scheme approach introduced in \cite{} and \cite{}
for hyperbolic problems on the sphere.
In recent years a lot of effort
has been devoted to import
ideas of numerical gas dynamics to numerical climatology.
Two particular examples are finite volumes upwind schemes 
with numerical fluxes. This approach involves
reconstruction with piecwise cubic recontsruction.
A variant is the Discontinuous Galerkin approach
in which several unknowns in a single computational cells are used.
In each of these two cases, the machinery of upwind schemes is adapted
to the specificity of the spherical context
and of the test cases. This involves in particular 
slope limiting. 

An important challenge for numerical schemes in numerical climatology 
is to calculate as accurately as possible 
the solution of linear equations up to a large physical time.
Here we show that our compact scheme performs well
for the two following problems:
\begin{itemize}
\item 
The linear scalar equation
advection 
\beq
\partial_t h(t,\mathbf{x})+ \mathbf{c}(t,\mathbf{x}) . \nabla_T h(t,\mathbf{x})=0
\eeq
The velocity $\mathbf{c}(t,\mathbf{x}) \in (0, +\infty) \times \mathbb{S}^2$ is prescribed
so that the scalar value $h(t,\mathbf{x})$ exhibits a moving rollup vortex.
This test case was introduced
in \cite{Nair-Machenhauer,Nair-Jablonowski}. We refer to Sections
\ref{sec:4.1} and \ref{sec:4.2} for setails.
\item
The linearized shallow water equations (LSWE). This equation
is expressed as:
\beq
\label{eq:76.10}
(LSWE) \left\{
\begin{array}{l}
\partial_t \mathbf{v}(t,\mathbf{x})+ g \nabla_T \eta(t,\mathbf{x}) + f(\mathbf{x}) \mathbf{k}(\mathbf{x}) \times
\mathbf{v}(t,\mathbf{x})=0\\
\partial_t \eta(t,\mathbf{x})+ H \nabla_T . \mathbf{v}(t,\mathbf{x})=0
\end{array}
\right.
\eeq
This system serves as a base for spherical waves on the sphere,
\cite{Paldor}. The state at rest is 
$(\mathbf{v}_0,\eta_0)=(0,H)$ and the 
The 3-components perturbation unknowns is
the vector $(t,\mathbf{x}) \mapsto (\mathbf{v}(t,\mathbf{x}), \eta(t,\mathbf{x})$.
\end{itemize}

The present approach is related to compact scheme
approach. In this sense, it belongs 
to a classical approach, which can
be traced back to early works
in approximation and interpolation theory, \cite{Collatz}.

Two specific applications in CFD where compact schemes
are  is Aeroacoustics, \cite{Visbal-Gaitonde, Tam-Webb} and Turbulence, \cite{Lele, Kim-Moin}.

Finite difference schemes 
for simulating problems in climatology have
actually attracted interest since 
more than 40 years, \cite{Arakawa}.

In both cases, we show 
that our purely Cartesian approach supports
the comparison with modern conservative schemes on unstructured grids, such as 
Discontinuous Galerkin or Finite-Volume schemes.
Note finally that Finite Difference methods were recently used
in numerical climatology in \cite{Ghader-Nordstrom}.

The outline of the paper is as follows.
In Section \ref{sec:2}, we recall the numerical calculation
of the gradient introduced in \cite{Croisille-10}. Then in Section 
\label{sec:3}, we present the numerical scheme with emphasis 
on the role of the filtering. Dissipation and dispersion analysis 
is given. Finally in Section \ref{sec:4}, we present 
numerical results on two vortex advection problems mentionned above.
These results show the accuracy of our scheme.
The accuracy is comparable to conservative schemes such as DG schemes \cite{Nair-Jablonowski}.

%% *** SECTION ***************************************************************************************************************

\section{Fourth order accurate spherical gradient}
\label{sec:2}
\subsection{Hermitian approach to partial derivatives on the sphere}
\label{sec:2.1}
In this section we present the principle
behind the calculation of the high-order accurate
approximate spherical gradient, as introduced in 
\cite{Croisille-10, Croisille-12}.
Consider a given function $ \mathbf{s} \in \mathbb{S}^2 \mapsto u(\mathbf{s})$ on the unit sphere
and a point $\bar{\mathbf{s}}$ where an approximate value of the tangential gradient
$\nabla_T u(\bar{\mathbf{s}})$ is required.
Consider a point $\mathbf{s}_0$ close to $\bar{\mathbf{s}}$ and two orthogonal great circles
$C_1$ and $C_2$ intersecting at $\mathbf{s}_0$. 
Denote by $\xi$ and $\eta$ the angles along $C_1$ and $C_2$ respectively.
The angles $(\xi,\eta)$ form a local coordinate system 
whose $\mathbf{s}_0(0,0)$ is the center. 
The tangential gradient $\nabla_T u(\bar{\mathbf{s}})$  is given by:
\beq
\label{eq:87.1}
\nabla_T u(\bar{\mathbf{s}})=
\Big(
\partial_\xi u(\bar{\mathbf{s}})
\Big)
g^\xi(\bar{\mathbf{s}})
+
\Big(
\partial_\eta u(\bar{\mathbf{s}})
\Big)
g^\eta(\bar{\mathbf{s}}).
\eeq
In (\ref{eq:87.1}), $(g^\xi(\mathbf{s}),g^\eta(\mathbf{s}))$
denotes the dual basis of the basis 
$(g_\xi(\mathbf{s}),g_\eta(\mathbf{s}))$ where
\beq
\label{eq:32.19}
g_\xi(\mathbf{s})=\frac{\partial \mathbf{s}}{\partial \xi},\;\;\;
g_\eta(\mathbf{s})=\frac{\partial \mathbf{s}}{\partial \eta}.
\eeq
Consider next the iso-$\eta$ curve passing through $\bar{\mathbf{s}}$.
This curve is locally defined as a function of the $\xi$ parameter as:
\beq
 \xi \in (\bar{\xi}-\varepsilon, \bar{\xi}+\varepsilon)
 \mapsto \mathbf{s}(\xi,\bar{\eta}), \;\;\; \varepsilon >0.
\eeq
Due to the orthogonality of the circles $C_1$ and $C_2$, this curve
is also an arc of great circle. We call $\bar{C}$ this great circle.
We define a discrete grid of $\bar{C}$ 
using the points with coordinates $\mathbf{s}_i(i\Delta \xi,\bar{\eta})$. The value
$\Delta \xi >0 $ is the constant step defined by
\beq
\Delta \xi = \frac{\pi}{2N}
\eeq 
and $N>0$ is an integer.
Assume for the moment that the point $\bar{\mathbf{s}}$ belongs to this grid and that 
$\bar{\mathbf{s}}=\mathbf{s}_i$ for some integer $i$.  A simple way 
to approximate $\nabla_T u(\bar{\mathbf{s}})$
is obtained by approximating in (\ref{eq:87.1}) 
the partial derivatives
$\partial_\xi u(\mathbf{s}_i)$ and $\partial_\eta u(\mathbf{s}_i)$.
Consider first $\partial_\xi u(\bar{\mathbf{s}})$.
Since $\bar{\mathbf{s}}=\mathbf{s}_i$, using 
the standard centered divided difference we have;
\beq
\label{eq:75.10}
\partial_\xi u(\mathbf{s}_i) \simeq 
\frac{u(\mathbf{s}_{i+1})- 
u(\mathbf{s}_{i-1})}{2 \Delta \xi}.
\eeq
The divided difference in the right-hand-side is denoted by $\delta_\xi u_i$.
Proceeding in the same manner in the $\eta$ direction, we set up
a grid on the circle $\bar{C}^\prime$:
the iso-$\xi$ great circle through by $\bar{\mathbf{s}}$ receives 
a grid with step size $\Delta \eta = \Delta_\xi$. The points
along this grid are numbered with index $j$ and we
call ${\mathbf{s}}=\mathbf{s}^\prime_j$. The value
$\partial_\eta u (\bar{s})$ is approximated by:
\beq
\label{eq:75.11}
\partial_\eta u(\bar{\mathbf{s}}) \simeq 
\delta_\eta u^\prime_j = \frac{u(\mathbf{s}^\prime_{j+1})- 
u(\mathbf{s}^\prime_{j-1})}{2 \Delta \eta}.
\eeq
A first candidate for the approximate value to $\nabla_T u(\bar{\mathbf{s}})$ is therefore:
\beq
\label{eq:87.2}
\nabla_{T,h} u(\bar{\mathbf{s}})=
\left(\delta_\xi u_i\right)
g^\xi(\bar{\mathbf{s}})
+
\left(\delta_\eta u^\prime_j \right)
g^\eta(\bar{\mathbf{s}}).
\eeq
The vector $\nabla_{T,h} u(\bar{\mathbf{s}})$ is obviously a second order 
approximation to $\nabla_T u(\bar{\mathbf{s}})$.
A simple way to go beyond second order
is to modifiy $\delta_\xi u_i$ using instead
the Hermitian derivative $\delta^H_\xi u_i$.
It is defined in terms of $\delta_\xi u_i$ by the relation
\beq
\label{eq:73.10}
\frac{1}{6} \delta_\xi^H u_{i-1}
+\frac{2}{3} \delta_\xi^H u_i
+\frac{1}{6} \delta_\xi^H u_{i+1}
= 
\delta_\xi u_i.
\eeq
The relation (\ref{eq:73.10}) defines implictely
$ \delta_\xi^H u_i$ as a perturbation of 
$\delta_\xi u_i$ since it can be expressed as:
\beq
\label{eq:73.14}
\delta_\xi^H u_i
= 
\delta_\xi u_i -\frac{\Delta^2\xi}{6} \delta^2_\xi \delta^H_\xi u_i
\eeq
The difference with (\ref{eq:75.10}) 
is that (\ref{eq:73.10}) involves values of $u$ along 
the full on $\bar{C}$ and not only the two neighboor values 
at $i\pm 1$.
Solving (\ref{eq:73.10}) provides $\delta^H u_i$.
This values satisfies the fourth-order consistency relation
\beq
\label{eq:34.18}
\delta^H_\xi u_i=
\partial_\xi u(\bar{\mathbf{s}})+ O(\Delta \xi^4)
\eeq
Proceeding in the same way along the $\eta-$ direction gives 
the approximation
\beq
\label{eq:34.19}
\delta^H_\eta u^\prime_j=
\partial_\eta u(\bar{\mathbf{s}})+ O(\Delta \xi^4)
\eeq
The Hermitian approximate gradient at the point $\bar{\bs}$ 
is therefore:
\beq
\label{eq:87.2.1}
\nabla^H_{T,h} u(\bar{\mathbf{s}})=
\left(\delta^H_\xi u_i\right)
g^\xi(\bar{\mathbf{s}})
+
\left(\delta^H_\eta u^\prime_j\right)
g^\eta(\bar{\mathbf{s}})
\eeq
It results from (\ref{eq:34.18}-\ref{eq:34.19}) that
$\nabla^H_{T,h} u(\bar{\mathbf{s}})$ satisfies the fourth order
consistency relation
\beq
\label{eq:87.4}
\nabla^H_{T,h} u(\bar{\mathbf{s}})=\nabla_{T} u(\bar{\mathbf{s}})+O(\Delta \xi^4)+O(\Delta \eta^4).
\eeq
The Hermitian approximation (\ref{eq:87.4}) is the basis of our approximate gradient on the Cubed-Sphere.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Approximate gradient on the Cubed-Sphere}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
The Cubed Sphere is a grid of the sphere. This grid and variants were introduced by
various authors. A systematic
presentation was given in
\cite{Ronchi-Iacono-Paolucci}.
This grid has been widely used for numerical climatology.
The Cubed-Sphere is composed of six panels with
label $(k)=(I), (II), (II), (IV), (V)$ and $(VI)$. Each panel matches
the face of the cube, in which the sphere
is embedded. Each panel
supports a Cartesian grid of size $N\times N$.
It is equipped with a 
coordinate system $(\xi,\eta)$.
As in the preceding section,
$\xi$ and $\eta$ are angles along a couple of orthogonal great circles
intersecting at the center of the panel.
A typical panel and the associated grid is represented
on Fig. \ref{fig:1}.
The  grid points are called $\mathbf{s}_{i,j}^{(k)}$ with $ (I) \leq (k) \leq (VI)$ and
$ -N/2 \leq i,j \leq N/2$. 
In panel $(k)$ and for all fixed $j$, the points  $ i \mapsto \mathbf{s}_{i,j}$ are 
located along a great circle. This essential property of the Cubed-Sphere
permits to follow the idea presented in Section \ref{sec:2.1}: 
the calculation of an approximate gradient at $\mathbf{s}^{(k)}_{i,j}$
by mean of Hermitian derivatives.
The approximate gradient
$\nabla_{T,h} u^{(k)}_{i,j}$ is given by
\beq
\label{eq:85.13}
\nabla_{T,h} u^{(k)}_{i,j}=
u_{\xi,i,j}^{(k)} \mathbf{g}^{\xi, (k)}_{i,j} 
+
u_{\eta,i,j}^{(k)} \mathbf{g}^{\eta, (k)}_{i,j} 
\eeq
As in the preceding section, the values $ u_{\xi,i,j}^{(k)}$ and $u_{\eta,i,j}^{(k)}$
are Hermitian approximation of the partial derivatives $\partial_\xi u(\mathbf{s}^{(k)}_{i,j})$ and
$\partial_\eta u(\mathbf{s}^{(k)}_{i,j})$. The calculation of 
these Hermitian derivatives are
based on a set of data located along two great circles called $\bar{C}_{i,j}$ and $\bar{C}^\prime_{i,j}$.
The data along $\bar{C}_{i,j}$ and $\bar{C}^\prime_{i,j}$
are of course based on specific points of the Cubed-Sphere.
The choice of these points is detailed in \cite{Croisille-10, Croisille-12}
and we refer to these two references for more details.
Even if no mathematical proof is available yet, 
numerical evidence show a consistency close to $4$.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}
   \def\svgwidth{0.4 \textwidth}
\input{drawing13.pdf_tex}
\caption{The points of a typical panel of the Cubed-Sphere are classified in three categories:
(i) Circles correspond to {\sl internal} points; (ii) Squares correspond to {\sl edge} points ;
(iii) Pentagons correspond to {\sl corner} points}
\label{fig:1}
\end{figure}

%% *** SECTION ***********************************************************************************************************************

\section{Centered compact scheme with filtering}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Our approximate scheme
uses a centered finite-difference approximation on the Cubed-Sphere.
In particular we do not use any kind of upwinding.
A stabilization mechanism is a linear filtering
at each time step. This kind of numerical 
algorithm is stronlgy related to so-called 
hyperviscous numerical diffusion.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
\subsection{Method of lines}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
We consider the convection equation on the sphere
with tangential velocity 
$(\mathbf{x} ,t) \in \mathbb{S}^2 \times \mathbb{R}_+ \mapsto \mathbf{c}(\mathbf{x},t)$.
\beq
\label{eq:978.23.1}
\left\{
\begin{array}{l}
\partial_t h(\mathbf{x},t)+\mathbf{c}(\mathbf{x},t) \cdot \nabla_s h(\mathbf{x},t)=0,\\
h(\mathbf{x},0)=h_0(\mathbf{x}).
\end{array}
\right.
\eeq
Existence and uniqueness for (\ref{eq:978.23.1}) is
obtained by the method of characteristics.
The task is to calculate
an approximation of $h(\mathbf{x},t)$.

Let
$t \mapsto h^{(k)}_{i,j}(t)$ be a semidiscrete approximation
in space of (\ref{eq:978.23.1}). This semi-discrete 
approximation is 
the solution of the differential system:
\beq
\label{eq:978.23.1a}
\left\{
\begin{array}{l}
{d h_{i,j}^k(t) \over dt} +\mathbf{c}^{(k)}_{i,j}(t)\cdot  \mathbf{\nabla} h h_{i,j}^k(t)=0,
\quad -M\leq i,j\leq M,\;\;\; I\leq k\leq VI,\\
h^{(k)}_{i,j}(0)=h_0(\mathbf{s}^{(k)}_{i,j})
\end{array}
\right.
\eeq
where $\mathbf{c}^{(k)}_{i,j}(t) \triangleq \mathbf{c}(\mathbf{s}^{(k)}_{i,j})(t)$.
Denote by $H(t) \triangleq  h^{(k)}_{i,j}(t)$ the gridfuntion
with components $h^{(k)}_{i,j}$. The equation (\ref{eq:978.23.1}) 
is expressed in vector form as:
\beq
\label{eq:71.10.3}
\frac{d}{dt}H(t)=J(t) H(t)
\eeq
where $J(t)$ is the matrix corresponding to
\beq
[J(t) H(t)]_{i,j}^{(k)} \triangleq 
-\bc^{(k)}_{i,j}(t)\cdot  \bgrad_{T,h} h_{i,j}^k(t).
\eeq
Since fourth order accuracy in space is expected, we proceed with 
the explicit in time RK 4 approxaimtion in time for
(\ref{eq:71.10.3}).
Let $\Delta t>0$ be a time-step. The RK4 time-scheme
is applied to (\ref{eq:71.10.3}).

\begin{equation}
\label{eq:300.41-1}
\left\{ 
\begin{array}{l}
K^{(0)} = J(t^n)H^{n}\\
K^{(1)} = J(t^{n+1/2})(H^{n}+\frac{1}{2}\Delta t K^{(0)})\\
K^{(2)} = J(t^{n+1/2})(H^{n}+\frac{1}{2}\Delta t K^{(1)})\\
K^{(3)} = J(t^{n+1})(H^{n}+\Delta t K^{(2)})\\
H^{n+1} = H^{n}
+\Delta t\Bigg(\frac{1}{6}K^{(0)}+\frac{1}{3}K^{(1)}
+\frac{1}{3}K^{(2)}+\frac{1}{6}K^{(3)}\Bigg).
\end{array}\right.
\end{equation}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Dissipation and dispersion analysis}
Finite difference schemes are usually described
by their dissipation and dispersion properties. 
A customary analysis of this kind is the so called {\sl modified equation}
analysis, \cite{Shokin}.  This analysis is usually 
performed on the linear advection equation
\beq
\partial_t u + c \partial_x u=0
\eeq
We recall next the main features of this analysis.
Consider a numerical scheme
\beq
\label{eq:76.10}
\frac{u^{n+1}_j-u^n_j}{\Delta t}
+ L_h u|^n_j =0
\eeq
In (\ref{eq:76.10}), the operator $L_h u^n_j$ approximates $-c \partial_x u$.
In operator form, the scheme (\ref{eq:76.10}) is rewritten as
\beq
\label{eq:56.10}
\frac{e^{\Delta t \partial_t}-1}{\Delta t} u^n_j = -L_h u|^n_j
\eeq
The Logarithm series provides the formal expansion 
\beq
\label{eq:87.12}
\partial_t = \frac{e^{\Delta t \partial_t}-1}{\Delta t}
-\frac{\Delta t}{2}\left(\frac{e^{\Delta t \partial_t}-1}{\Delta t}\right)^2
+\frac{\Delta t}{3}\left(\frac{e^{\Delta t \partial_t}-1}{\Delta t}\right)^3
-\frac{\Delta t}{4}\left(\frac{e^{\Delta t \partial_t}-1}{\Delta t}\right)^4
+....
\eeq
Using (\ref{eq:56.10}) in the right hand side of (\ref{eq:87.12}),
we obtain an identity of the form
\beq
\label{eq:34.13}
\partial_t u+ c \partial_x u=c \Big[
  E_1 h \partial_x^{(2)}u 
+ E_2 h^2 \partial_x^{(3)}u 
+ E_3 h^3 \partial_x^{(4)}u 
+ E_4 h^4 \partial_x^{(5)}u 
+...
\Big]
\eeq
This identity is called the modified equation of the scheme. It represents a transport equation
with a perturbation in the form of an asymptotic expansion
in powers of $h$. The coefficients $E_\alpha$ depends
only the Courant number $\lambda= c \Delta t /h$. 
In the case of the scheme (), the modifed equation 
is expressed as:
\beq
\partial_t u+ c \partial_x u=c\Big[ \frac{h^4}{360}(3 \lambda^4+2) \partial_x^{(5)}u
+ \sum_\alpha h^{\alpha}E_\alpha \partial_x^{(\alpha+1)}u
\eeq
The first coefficients are 
\beq
\label{eq:72.10}
\left\{
\begin{array}{l}
E_4= \frac{1}{360}(3 \lambda^4+2)\\
E_5= \frac{1}{144}\lambda^5\\
E_6= \frac{1}{3024}(-2+9\lambda^6)\\
E_7= \frac{1}{1152}\lambda^7\\
E_8= \frac{1}{25920}(\lambda^4-1)(5 \lambda^4-1)\\
E_9= -\frac{1}{4320}\lambda^5
\end{array}
\right.
\eeq
As a result the scheme is $4-$order. In addition it is found to
be dissipative for the term in $\partial_x^{(6)}$ but antidissipative
with the terms in $\partial_x^{(8)}$ and  $\partial_x^{(10)}$.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Tenth-order hyperviscosity}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\label{sec:4}
As described in the previous section, stabilisation mechanism could be useful
to obtain a better stability profile. 
In such a situation a high-order filtering is added at each time step. 
Numerical practice showed
that a tenth-order filter from \cite{Visbal-Gaitonde} gives good results.
At each time step the value $H^{(n)}$ in (\ref{eq:300.41-1}) is replaced 
by $\mathcal{F} H^{(n)}$ where $\mathcal{F}$ is the filtering operator
acting on the gridfunctions defined by 
the composition of two one-dimensional filters along the $\xi$ and the $\eta$ directions on each panel:
\beq
\mathcal{F}=\mathcal{F}_\xi \circ \mathcal{F}_{\eta}
\eeq
For a one-dimensional grid function $u_j$,
The filter $\mathcal{F}$ belongs to the class 
of the filters 
\beq
\label{eq:75.10.3}
\alpha_f u_{F,i-1}+
u_{F,i}+
\alpha_f u_{F,i+1}=
\sum_{^j=0}^J \frac{a_j}{2}(u_{i+j}+u_{i-j})
\eeq
This kind of filtering was originally introduced
in the Atmospheric Sciences community \cite{Alpert}.
The values of the coefficients in (\ref{eq:75.10}) are given
in \cite{Visbal-Gaitonde}. 
Our numerical results were performed 
with the explicit filter, corresponding to
$\alpha_f=0$ and to the coefficients:
\beq
\label{eq:978.25.3}
\left(
\begin{array}{c}
a_0\\
a_1\\
a_2\\
a_3\\
a_4\\
a_5
\end{array}
\right)
=
\left(
\begin{array}{c}
193/256\\
105/256\\
-15/64\\
45/512\\
-5/256\\
1/512
\end{array}
\right).
\eeq
The fact that () acts as a filter is reflected 
by the values of 
coefficients in (\ref{eq:72.10}) in the modified equation modified equation.
The term in $\partial_x^{(10)} u$ is now dissipative insted of being
antidissitaive without filter. It is now 
\beq
E_9= -\frac{1}{138240}\frac{32\lambda^6-135}{\lambda}
\eeq
All these results were obtained with MAPLE.

%% *** SECTION ************************************************************************************************************************

\section{Numerical results}
%\section{Two vortex propagation test-cases with 
%deformational velocity}
In this section we present numerical results obtained
for a family of linear convection equations on the sphere 
with deformational velocity. This family
originates from \cite{Nair-Cote-Stanisforth, Nair-Machenhauer, Nair-Jablonowski}.
The equation is of the form (\ref{eq:978.23.1}).
The velocity $(\mathbf{x},t) \mapsto \mathbf{c}(\mathbf{c},t)$ is prescribed as follows.
The simplest problem of this kind is the Cosine-bell 
advection problem \cite{Swarztrauber-Williamson-Drake}. It corresponds
to a solid body velocity.
Numerical results for this problem
using the scheme (\ref{eq:300.41-1})
have been reported in 
\cite{Croisille-10}. 
Here we consider two more challenging problems of the form
(\ref{eq:978.23.1}) involving transport and roll-up effects
of vortices. 
The mathematical basis leading 
to the analytical solution is given in
\cite{Nair-Cote-Stanisforth}.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\subsection{Deformational stationary spherical vortex}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\label{sec:4.1}
\subsection{Nair-Machenhauer test case}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
\label{sec:4.1}
This test case \cite{Nair-Machenhauer}
considers
as initial condition $h(0,\mathbf{x})$
two vortices located
at diammetrally opposite points on the sphere.
These points are called $P$ (for North) and $P^\prime$ (for South).
The point $P$ has coordinates $(\lambda_P,\theta_P)$ in the reference
longitude-latitude system.
The longitude-latitude coordinate system 
$(\lambda^\prime,\theta^\prime)$ is associated to 
the axis $P  P^\prime$. The two vortices evolve in a roll-up
letting appear a finer and finer rollup structure when time increases.
We call $\Bbb S^2_R$ the sphere with radius $R$, 
\cite{Nair-Cote-Stanisforth,Nair-Machenhauer}.
Let us define the velocity $\mathbf{x} \in \mathbb{R}^2 \mapsto V(\mathbf{x})$ 
by
\begin{equation}
\left\{
\begin{array}{l}
\rho(\mathbf{x})=\rho_0 \cos(\theta^\prime)\\
V(\mathbf{x}) = v_0 \dfrac{3 \sqrt{3} }{2} \sech^2 ( \rho ) \tanh ( \rho )
\end{array}
\right.
\end{equation} 
The angular velocity $\theta^\prime \mapsto \omega_r(\theta^\prime)$ 
corresponding to $V$ 
is defined by:
\begin{equation}
   \omega_r ( \theta' ) = \left\{ 
   \begin{array}{ll}
      V/( R \rho ) & \text{ if } \rho \neq 0 \\
      0 & \text{ if} \rho =0
   \end{array}
   \right.
\label{vitesse_angulaire}
\end{equation}
Define now the tangential velocity on the sphere $\mathbb{S}^2_R$ 
appearing in (\ref{eq:978.23.1}) by
by:
\beq
\mathbf{c}(\mathbf{x},t)=c_{\lambda^\prime} \mathbf{e}_{\lambda^\prime}+
c_{\theta^\prime} \mathbf{e}_{\theta^\prime}
\eeq
with
\beq
\left\{
\begin{array}{l}
c_{\lambda^\prime}=\cos(\theta^\prime) \omega_r(\theta^\prime)\\
c_{\theta^\prime}=0
\end{array}
\right.
\eeq
Switching back to the $(\mathbf{e}_\lambda,\mathbf{e}_\theta)$ basis, one obtains
\beq
\mathbf{c}(\mathbf{x},t)=\mathbf{c}(\mathbf{x})=c_{\lambda} \mathbf{e}_{\lambda}+
c_{\theta} \mathbf{e}_{\theta}
\eeq
with
\begin{equation}
\left\{
\begin{array}{l}
c_{\lambda} = R \omega_r ( \theta' ) \left[ \sin \theta_p \cos \theta - \cos \theta_p \cos ( \lambda - \lambda_p ) \sin \theta \right]\\
c_{\theta} = R \omega_r ( \theta' ) 
\left[ \cos \theta_p \sin ( \lambda - \lambda_p ) \right]
\label{eq:78.10}
\end{array}
\right.
\end{equation}
Now, the solution $(\mathbf{x}, t) \in \mathbb{S}_R^2 \times \mathbb{R}_{-}+ \mapsto
\phi(\mathbf{x},t)$ is given in coordinates $(\lambda^\prime,\theta^\prime,t)$ by
\begin{equation}
\phi ( \lambda^\prime , \theta', t ) 
= 
1 - \tanh \left[ \dfrac{\rho_0\cos(\theta^\prime)}{\gamma} \sin ( \lambda' 
- \omega_r(\theta^\prime) t ) \right],\;\;\; \rho(\theta^\prime)= 
\rho_0 \cos(\theta^\prime)
\label{NM_exacte}
\end{equation}
The constant $\gamma$
determines the strenght of $\nabla_T\phi$ and $\rho_0>0$ 
is a reference distance to the center of the vortex.
Let $T>0$ be the physical time of evolution and $v_0 = 2 \pi R / T$ ($R$=radius)
be a reference velocity. 
In this article, for a smooth flow, we choose the parameters $\rho_0 = 3$ and $ \gamma = 5$.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
%% \subsubsection{Numerical results}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
In Figures \ref{erreur_cfl=0.05} and \ref{erreur_cfl=0.5}, the error history
is reported for CFL numbers $\CFL=0.05$ and $\CFL=0.5$.
The Cubed Sphere grid has a parameter $N=35$, which corresponds 
to an equatorial resolution $\Delta \lambda = 2.6 \deg$. 
This is a spatial resolution similar to the one 
in \cite{Nair-Jablonowski}
where a Discontinuous Galerkin (DG) scheme is used.
As can be observed, the error growth is regular.
The error behaviour is similar for the angles 
$\alpha=0$ and $\alpha=45\deg$, which shows 
that there is no apparent influence
of the corners of the Cubed Sphere.

We have performed two different runs. The first corresponds
to a $\CFL=0.05$. In this case, 
the error is dominated by the 
space approximation.
The error levels that are reached are of the same order of magnitude 
than the ones obtained with the DG scheme in \cite{Nair-Jablonowski}.
In the second case, we use $\CFL=0.5$.  The scheme remains stable.
The error consists of the combination
of the space and time accuracy.
The error is slightly smaller than with $\CFL=0.05$. 
This is a standard behaviour for convection problems.
%corresponds to
%that numerical scheme oftenly exhiblits some kind of enhanced convergence 
%when the $\CFL$ number is closer from $1$, in the case of convection problems.
Table \ref{table:2.4} reports the convergence rate 
in the three norms $1$, $2$ and $\sup$. It can be observed
that the error is of order $4$ for the norms $1$ and $2$. It
is a slightly less accurate for the $\infty$ norm with 
an observed rate of $3.77$. 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}[!ht]
\includegraphics[scale=0.3]{ref_7363118528_normerreur_test_1.png}
\includegraphics[scale=0.3]{ref_7363107978_normerreur_test_1.png}
\label{erreur_cfl=0.05}
\caption{Error plots with $N=35$; $\CFL=0.05$. Left panel: 
The point $P$ defining the axis has spherical coordinates  $(\lambda_P,  \theta_P) = (\pi / 4, \pi / 4)$. and $(\lambda_P, \theta_P) = (0,0)$ (right) for the Nair and Machenhauer test case.}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}[!ht]
\includegraphics[scale=0.3]{ref_7363117229_normerreur_test_1.png}
\includegraphics[scale=0.3]{ref_7363106861_normerreur_test_1.png}
\label{erreur_cfl=0.5}
\caption{Error curves $N=35$; $cfl=0.5$; $(\lambda_P,  \theta_P) = (\pi / 4, \pi / 4)$ (left) and $(\lambda_P, \theta_P) = (0,0)$ (right) for the Nair and Machenhauer test case.}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}
\label{table:2.4}
\begin{tabular}{c||cc|cc|cc}
$N$ & $max_n |e_1^n|$ & order  & $max_n |e_2^n|$ & order  & $max_n |e_{\infty}^n|$ & order \\
\hline
\hline
$40\;(2.25\deg)$ & $8.5139 (-4)$ & -  & $3.6312 (-3)$ & - & $2.2124 (-2)$  & - \\
\hline 
$50\;(1.80\deg)$ & $2.8785 (-4)$ & $4.9687$ & $1.3338 (-3)$ & $4.5888$ & $8.7387 (-3)$ & $4.2561$ \\
\hline
$60\;(1.50\deg)$ & $1.0498 (-4)$ & $5.6335$ & $5.0056 (-4)$ & $5.4737$ & $3.5278 (-3)$ & $5.0662$ \\
\hline
$80\;(1.125\deg)$ & $2.0144 (-5) $ & $5.8216$ & $9.4818 (-5)$ & $5.8671$ & $7.3279 (-4)$ & $5.5420$ \\
\hline
$100\;(0.90\deg)$ & $6.9960 (-6)$ & $4.7925$ & $3.2964 (-5)$ & $4.7879$ & $2.6738 (-4)$ & $4.5687$\\
\hline
$150\;(0.60\deg)$ & $1.0231 (-6)$ & $4.7804$ & $5.1609 (-6)$ & $4.6109$ & $5.3299 (-5)$ & $4.0102$
\end{tabular}
\caption{Convergence analysis for the Nair and Machenhauer test case \cite{Nair-Machenhauer}. 
$N=31$; $\CFL = 0.7$; $(\lambda_p, \theta_p) = (0,0)$.}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\subsection{Deformational moving spherical vortex}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Nair-Jablonowski test case}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\label{sec:4.2}
In \cite{Nair-Jablonowski} a modification of the stationary vortex problem of
Section \ref{sec:4.1} was suggested. It combines 
the deformational roll-up effect of the 
preceding case
with a solid body rotation.
The analytical solution is given in \cite{Nair-Jablonowski}.
The advection velocity $\mathbf{c}(\mathbf{x},t)$ in (\ref{eq:978.23.1}) is
obtained as the sum
\beq
\mathbf{c}=\mathbf{c}_s +\mathbf{c}_r
\eeq
where $\mathbf{c}_s$ is a solid rotation velocity and 
$\mathbf{c}_r$ is a "static" velocity centered at the center 
of the vortex. The velocity $\mathbf{c}_r$ is actually time dependant 
since in \eqref{eq:78.10}
%\eqref{vitesse_lambda_mach}-\eqref{vitesse_theta_mach====}, 
$(\lambda_P, \theta_P)$ must be remplaced by the solid body advected 
position given  by 
\begin{equation}
(\lambda_s', \theta_s') = (\lambda_0' + w_s t, \theta_0')
\end{equation}
where $(\lambda_0', \theta_0')$ is the initial position of the vortex.
On the other hand, the solid-body velocity is given by
\begin{equation}
c_{\lambda, r} = R \omega_s \left( \sin \theta_p \cos \theta - \cos \theta_p \cos ( \lambda - \lambda_p ) \sin \theta \right)
\label{vitesse_lambda_bump}
\end{equation}
\begin{equation}
c_{\theta, r} = - R \omega_s \cos \theta_p \sin ( \lambda - \lambda_p )
\label{vitesse_theta_bump}
\end{equation}
where

$\omega_s = v_0 / R = 2 \pi / T $ and $( \lambda_p, \theta_p$ )  
is the coordinates of the point $P$.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%\subsubsection{Numerical results}
The error growth is reported on Fig. \ref{erreur_cfl=0.05a}
and \ref{erreur_cfl=0.5a}. The magnitude of the error
is very close from the stationary case. However it appears 
slightly less regular. Table \ref{table:2} reports
as before fourth-order accuracy. Note also that the level
of error are very close to the ones reported in
\cite{Nair-Jablonowski} with a DG scheme. Finally
Fig. \ref{coupe-NJ-1} displays a slice of the vortex after 12 days
withgrid sizes $N=30$ and $N=60$. 
The matching with the finest grid
is excellent. No dispersion or dispersion is obervable.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}[!ht]
\includegraphics[scale=0.3]{04-Nov-2015ref_7362724687_snapshot_test_2_nday_0.png}
\includegraphics[scale=0.3]{04-Nov-2015ref_7362724281_snapshot_test_2_nday_3.png}

\includegraphics[scale=0.3]{04-Nov-2015ref_7362724321_snapshot_test_2_nday_6.png}
\includegraphics[scale=0.3]{04-Nov-2015ref_736272438_snapshot_test_2_nday_9.png}

\includegraphics[scale=0.3]{04-Nov-2015ref_7362724445_snapshot_test_2_nday_12.png}
\caption{Nair and Jablonowski test-case. Approximate solution of the vortex after 
0, 3, 6, 9 and 12 days. The resolution is $N=31$. Numerical parameters are 
$N=31$, $\CFL = 0.7$ and $\alpha = 3 \pi / 4$.}
\label{SNAPSHOT}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}[!ht]
\includegraphics[scale=0.3]{ref_7363120098_normerreur_test_2.png}
\includegraphics[scale=0.3]{ref_7363117115_normerreur_test_2.png}
\label{erreur_cfl=0.05a}
\caption{Error curves $N=35$; $\CFL=0.05$; $\alpha = \pi / 4$ (left) et $\alpha = 0$ (right) for the Nair and Jablonowski test case \cite{Nair-Jablonowski}.}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}[!ht]
\includegraphics[scale=0.3]{ref_7363117471_normerreur_test_2.png}
\includegraphics[scale=0.3]{ref_7363115928_normerreur_test_2.png}
\label{erreur_cfl=0.5a}
\caption{Error curves $N=35$; $\CFL=0.5$; $\alpha = \pi / 4$ (left) et $\alpha = 0$ (right) for the Nair and Jablonowski test case \cite{Nair-Jablonowski}.}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}
\begin{tabular}{c||cc|cc|cc}
$N$ & $max_n |e_1^n|$ & ordre  & $max_n |e_2^n|$ & ordre  & $max_n |e_{\infty}^n|$ & ordre \\
\hline
\hline
$40$ & $2.7609 (-3)$ & -  & $9.7386 (-3)$ & - & $5.4808 (-2)$  & - \\
\hline 
$50$ & $1.2760 (-3)$ & $3.5364$ & $5.0160 (-3)$ & $3.0399$ & $3.2035 (-2)$ & $2.4605$ \\
\hline
$60$ & $6.2957 (-4)$ & $3.9456$ & $2.6157 (-3)$ & $3.6365$ & $1.8218 (-2)$ & $3.1523$ \\
\hline
$80$ & $1.9603 (-4) $ & $4.1145$ & $8.3722 (-4)$ & $4.0173$ & $6.0931 (-3)$ & $3.8623$ \\
\hline
$100$ & $8.0399 (-5)$ & $4.0389$ & $3.4524 (-4)$ & $4.0143$ & $2.6514 (-3)$ & $3.7706$\\
\hline
$150$ & $1.5656 (-5)$ & $4.0684$ & $6.9199 (-5)$ & $3.9966$ & $5.8082 (-4)$ & $3.7756$
\end{tabular}
\label{table:2}
\caption{Convergence analysis for the Nair and Jablonowski test case \cite{Nair-Jablonowski} ; $cfl = 0.7$ ; $\alpha = \pi /4$.}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}[!ht]
\includegraphics[scale=0.5]{ref_7363158648_coupefaceI_equateur_test_1.jpg}
\label{coupe-NJ-1}
\caption{Nair and Jablonowski test case \cite{Nair-Jablonowski}. Slice 
of the vortex after $12$ days. Solid line: exact solution, circles:
approximate solution with $N=30$. Crosses: approximate solution with $N=60$}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{A damped case of LSWE}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
This test serves to assess the accuracy of the 
gradient and divergence approximation () and () when
used in the LSWE system (\ref{eq:76.10}). 
Consider the two exponentially in time damped functions
\beq
\tilde{\mathbf{v}} (t,\mathbf{x})=\mathbf{u}_0 \varphi(\theta) e^{-\sigma t}\mathbf{e}_\lambda(\mathbf{x})\\
\tilde{\eta}(t,\mathbf{x})= \eta_0 \varphi(\theta) \sin(\lambda)e^{-\sigma t} 
\eeq
The system to solve is
\beq
\label{eq:76.11}
(LSWE) \left\{
\begin{array}{l}
\partial_t \mathbf{v}(t,\mathbf{x})+ \mathbf{g} \nabla_T \eta(t,\mathbf{x}) + f(\mathbf{x}) \mathbf{k}(\mathbf{x}) \times
\mathbf{v}(t,\mathbf{x})=S_{\eta}(t,\mathbf{x})\\
\partial_t \eta(t,\mathbf{x})+ H \nabla_T . \mathbf{v}(t,\mathbf{x})=S_{\mathbf{v}}(t,\mathbf{x})
\end{array}
\right.
\eeq
In (\ref{eq:76.11}), $\mathbf{g}$ is the gravity vector and $\mathbf{k}(\mathbf{x})$ is the exterior
normal vector.
The source terms $S_{\eta}$ and $S_{\mathbf{v}}$ are defined 
such as the functions $(\tilde{\mathbf{v}}(t,\mathbf{x}), \tilde \eta(t,\mathbf{x}))$ be solution
of (\ref{eq:76.11}).
Remarks:\\
- Gradient and divergence are calculated according to ().\\
- Filtrage ou non ?
- Valeurs numériques de $H,g, u_0, \eta_0$ ?
- Autres essais  avec temps plus long ?
A numerical grid convergence analysis is reported in 
Table \ref{table:4}.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{figure}
\begin{tabular}{||c|c|c|c|c|c||}
\hline
& N=40 & rate & N=60  & rate & N=80 \\
\hline 
$\vert \mathbf{v}^1_{ex}(T)-\mathbf{v}^1_{cal}(T)\vert_{h,I}$ & 2.52(-5)  &  4.15 & 4.69(-6) &  2.98 & 1.40(-6)   \\
\hline 
$\vert \eta_{ex}(T)-\eta_{cal}(T)\vert_{h,I}$ & 1.06(-5)  &  3.85 & 2.70(-6) &  3.32 & 1.04(-6) \\
\hline 
\end{tabular}
\caption{Hermitian scheme applied to an exponential decaying solution of the LSWE. Final time = 1h30}
\label{table:4}
\end{figure}

A convergence rate between $3$ and $4$ can be observed.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{A time independent solution zonal solution 
of LSWE}
In this test case, we consider a time independent 
solution of LSWE depending on the latitude only.
Consider a tangential velocity field of the form. 
If the parameter function $\theta \mapsto \varphi(\theta)=\exp(\frac{1}{(\theta-\theta_0)(\theta-\theta_1)})$, then
we define the 
spherical velocity $\mathbf{v}(\mathbf{x})$ on the sphere by:
\beq
\mathbf{v}(\mathbf{x})=u_0 \varphi(\theta) \mathbf{e}_\lambda(\mathbf{x})
\eeq
The momentum equation () is equivalent to the 
following relation:
%% The matching atmosphere thickness is $\eta(\bx)$:
\beq
\eta(\mathbf{x})=\eta_{eq}-\frac{a}{g}\int_0^\theta f(s) \varphi(s) ds
\eeq
Our numerical test consists now in testing if the scheme preserve during time stepping 
the time independant solution defined by .....
This is a zonal divergence free solution
of the LSWE depending on the latitude $\theta$ only.
This test case is meaningful, 
first to assess the accuracy of the spatial approximation. In particular, 
spurious modes can pollute the numerical solution.
Second this test allows to test the accuracy of the numerical divergence 
preserving on 
large intervals of time.
The numerical results are reported in Table \ref{table:5}.

\begin{figure}
\begin{tabular}{||c|c|c|c|c|c||}
\hline 
&N=40 & rate & N=60  & rate & N=80 \tabularnewline
\hline
$\vert \mathbf{v}^1_{ex}(T)-\mathbf{v}^1_{cal}(T)\vert_{h,I}$ & 2.73(-5)  &  4.09 & 5.18(-6) &  4.24 & 1.53(-6) \\
\hline 
$\vert \eta_{ex}(T)-\eta_{cal}(T)\vert_{h,I}$ & 1.21(-5)  &  3.95 & 2.43(-6) &  3.14 & 7.38(-7) \\
\hline 
\end{tabular}
\caption
{Hermitian scheme applied to a time independent solution of the LSWE. Final time = 1h30}
\label{table:5}
\end{figure}

%% *** CONCLUSION *********************************************************************************************************************

\section{Conclusion}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
In this paper, we show that compact approximations in the
on the Cubed Sphere lead to accurate numerical simulations
for hyperbolic problems on the sphere.
The present approach makes use 
of the standard finite difference design.
Since the scheme is centered, some numerical viscosity
needs to be added for time dependent solutions.
In our case, a high order filter is added.
Fourth order accuracy was numerically observed.
The quality of the numerical results can be compared
to the best conservative schemes on irregular grids, such as Discontinuous Galerkin schemes.

Current research involves mathematical analysis
of the scheme, in particular conservation properties.
The same logic can be applied to any form
of the SW system on the sphere.

%% *** BIBLIO *************************************************************************************************************************
\bibliographystyle{plain}
\bibliography{bibox_4apr11_no_issue}
\end{document}